(this["webpackJsonpclien-chat-video"]=this["webpackJsonpclien-chat-video"]||[]).push([[0],{106:function(e,t,c){},138:function(e,t){},140:function(e,t){},156:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(9),s=c.n(a),l=(c(106),c(12)),r=c(59),i=c.n(r),j=c(57),o=c.n(j),b=c(55),u=c.n(b),d=c(91),m=c(92),O=c(56),h=c.n(O),x=c(2),f=Object(n.createContext)(),v=Object(m.io)("https://chat-video-react-v1.herokuapp.com/"),p=function(e){var t=e.children,c=Object(n.useState)(null),a=Object(l.a)(c,2),s=a[0],r=a[1],i=Object(n.useState)(""),j=Object(l.a)(i,2),o=j[0],b=j[1],m=Object(n.useState)({}),O=Object(l.a)(m,2),p=O[0],N=O[1],g=Object(n.useState)(!1),C=Object(l.a)(g,2),y=C[0],w=C[1],S=Object(n.useState)(!1),k=Object(l.a)(S,2),A=k[0],E=k[1],I=Object(n.useState)(""),R=Object(l.a)(I,2),U=R[0],V=R[1],D=Object(n.useState)(!0),F=Object(l.a)(D,2),M=F[0],z=F[1],P=Object(n.useRef)(),H=Object(n.useRef)(),J=Object(n.useRef)();Object(n.useEffect)((function(){(function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()(M).then((function(e){r(e),P.current.srcObject=e}))}),[M]),Object(n.useEffect)((function(){v.on("conn",(function(e){return b(e)})),v.on("callUser",(function(e){var t=e.from,c=e.name,n=e.signal;N({isReceivedCall:!0,from:t,name:c,signal:n})}))}),[]);return Object(x.jsx)(f.Provider,{value:{call:p,callAccepted:y,myVideo:P,userVideo:H,idConnect:o,stream:s,name:U,callEnded:A,setName:V,callUser:function(e){var t=new h.a({initiator:!0,trickle:!1,stream:s});t.on("signal",(function(t){v.emit("callUser",{userToCall:e,signalData:t,from:o,name:U})})),t.on("stream",(function(e){H.current.srcObject=e})),v.on("callAccepted",(function(e){w(!0),t.signal(e)})),J.current=t},answerCall:function(){w(!0);var e=new h.a({initiator:!1,trickle:!1,stream:s});e.on("signal",(function(e){v.emit("answerCall",{signal:e,to:p.from})})),e.on("stream",(function(e){H.current.srcObject=e})),e.signal(p.signal),J.current=e},leaveCall:function(){E(!0),J.current.destroy(),window.location.reload()},setMic:z,mic:M},children:t})},N=function(){return Object(n.useContext)(f)},g=function(){var e=N(),t=e.mic,c=e.setMic,a=e.call,s=e.callAccepted,r=e.myVideo,j=e.userVideo,b=e.stream,u=e.name,d=e.callEnded,m=Object(n.useState)(!0),O=Object(l.a)(m,2),h=O[0],f=O[1],v=Object(n.useState)("mx-auto col-md-8 col-sm-12 p-3"),p=Object(l.a)(v,2),g=p[0],C=p[1];Object(n.useEffect)((function(){s&&C("mx-auto col-md-6 col-sm-12 p-3")}),[s]);return Object(x.jsx)("div",{className:"col-md-12",children:Object(x.jsxs)("div",{className:"row",children:[b&&Object(x.jsxs)("div",{className:g,children:[Object(x.jsx)("div",{children:Object(x.jsxs)("h4",{children:["Your Name: ",u||"name"]})}),Object(x.jsx)("video",{className:"w-100 border border-success",ref:r,playsInline:!0,autoPlay:!0}),Object(x.jsx)("div",{className:"mt-2 text-center",children:Object(x.jsx)("button",{className:"btn btn-outline-secondary",onClick:function(){c(!t)},children:t?Object(x.jsxs)(x.Fragment,{children:["mute ",Object(x.jsx)(o.a,{})]}):Object(x.jsxs)(x.Fragment,{children:["unmute ",Object(x.jsx)(i.a,{})]})})})]}),s&&!d&&Object(x.jsxs)("div",{className:g,children:[Object(x.jsx)("div",{children:Object(x.jsx)("h4",{children:a.name||"boss"})}),Object(x.jsx)("video",{className:"w-100 border border-success",ref:j,playsInline:!0,autoPlay:!0,muted:h}),Object(x.jsx)("div",{className:"mt-2 text-center",children:Object(x.jsx)("button",{className:"btn btn-outline-secondary",onClick:function(){return f(!h)},children:h?Object(x.jsxs)(x.Fragment,{children:["unmute ",Object(x.jsx)(i.a,{})]}):Object(x.jsxs)(x.Fragment,{children:["mute ",Object(x.jsx)(o.a,{})]})})})]})]})})},C=c(98),y=c(190),w=c(191),S=c(192),k=c(193),A=function(e){var t=e.children,c=N(),a=c.callAccepted,s=c.idConnect,r=c.name,i=c.callEnded,j=c.setName,o=c.callUser,b=c.leaveCall,u=Object(n.useState)(""),d=Object(l.a)(u,2),m=d[0],O=d[1];return Object(x.jsxs)("div",{className:"mt-3 col-md-12",children:[Object(x.jsx)("div",{className:"mb-2",children:t}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-md-6 col-sm-12 p-3",children:Object(x.jsxs)("form",{className:"bg-light p-3 rounded",children:[Object(x.jsx)("h4",{className:" mb-3",children:"Account Info"}),Object(x.jsx)(k.a,{label:"Name",value:r,onChange:function(e){return j(e.target.value)},fullWidth:!0}),Object(x.jsx)(C.CopyToClipboard,{text:s,children:Object(x.jsxs)("button",{type:"button",className:"w-100 btn btn-primary mt-3",children:["Copy your ID ",Object(x.jsx)(y.a,{fontSize:"large"})]})})]})}),Object(x.jsx)("div",{className:"col-md-6 col-sm-12 p-3",children:Object(x.jsxs)("form",{className:"bg-light p-3 rounded",children:[Object(x.jsx)("h4",{className:"mb-3",children:"Make a call"}),Object(x.jsx)(k.a,{label:"ID to call",value:m,onChange:function(e){return O(e.target.value)},fullWidth:!0}),a&&!i?Object(x.jsxs)("button",{type:"button",className:"w-100 btn btn-danger mt-3",onClick:b,children:["Hang up ",Object(x.jsx)(w.a,{fontSize:"large"})]}):Object(x.jsxs)("button",{type:"button",className:"w-100 btn btn-success mt-3",onClick:function(){return o(m)},children:["Call ",Object(x.jsx)(S.a,{fontSize:"large"})]})]})})]})]})},E=function(){var e=N(),t=e.call,c=e.callAccepted,n=e.answerCall;return Object(x.jsx)("div",{className:"mb-5",children:t.isReceivedCall&&!c&&Object(x.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(x.jsxs)("h3",{children:[t.name," is calling: "]}),Object(x.jsx)("button",{className:"mx-3 btn btn-secondary",onClick:n,children:"Answer"})]})})};var I=function(){return Object(x.jsxs)("div",{className:"container mt-4",children:[Object(x.jsx)("div",{className:"text-center",children:Object(x.jsx)("h1",{children:"Video chat (Hi\u1ec7n c\xf2)"})}),Object(x.jsx)("div",{children:Object(x.jsx)(g,{})}),Object(x.jsx)("div",{children:Object(x.jsx)(A,{children:Object(x.jsx)(E,{})})})]})};s.a.render(Object(x.jsx)(p,{children:Object(x.jsx)(I,{})}),document.getElementById("root"))}},[[156,1,2]]]);
//# sourceMappingURL=main.141acba2.chunk.js.map